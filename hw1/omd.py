from pyowm.owm import OWM
import time
from random import choices, choice
from PIL import Image


def step1():
    print(
        '–£—Ç–∫–∞-–º–∞–ª—è—Ä ü¶Ü —Ä–µ—à–∏–ª–∞ –≤—ã–ø–∏—Ç—å –∑–∞–π—Ç–∏ –≤ –±–∞—Ä. '
        '–í–∑—è—Ç—å –µ–π –∑–æ–Ω—Ç–∏–∫? ‚òÇÔ∏è'
    )
    option = ''
    options = {'–¥–∞': True, '–Ω–µ—Ç': False}
    while option not in options:
        print('–í—ã–±–µ—Ä–∏—Ç–µ: {}/{}'.format(*options))
        option = input()

    if options[option]:
        return step2_umbrella()
    return step2_no_umbrella()


# –≤–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞, –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –æ—Å–∞–¥–∫–∏
def get_humidity():
    owm = OWM('584fe9e12a0d09ecd3d724add7a46a32')
    mgr = owm.weather_manager()
    observation = mgr.weather_at_place('Saint Petersburg,RU')
    weather = observation.weather
    return weather.humidity / 100


def step2_umbrella():
    humidity = get_humidity()
    rain_on_the_way = choices([0, 1], [1 - humidity, humidity], k=10)

    good_weather = [
        '–û—Ç–ª–∏—á–Ω–∞—è –ø–æ–≥–æ–¥–∞, —Å–∞–º–æ–µ –≤—Ä–µ–º—è –ø—Ä–æ–≥—É–ª—è—Ç—å—Å—è',
        '–ö–∞–∫ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –Ω–∞ —É–ª–∏—Ü–µ, –º–æ–∂–Ω–æ –∏ –∫—Ä—É–≥ –ø–æ –¥–æ—Ä–æ–≥–µ —Å–¥–µ–ª–∞—Ç—å',
        '–ü–æ–∫–∞ –∏ —Ç—É—á–µ–∫ –Ω–µ –≤–∏–¥–∞—Ç—å, –º–æ–∂–µ—Ç –∏ –ø—Ä–æ–Ω–µ—Å–µ—Ç',
    ]

    good_weather_after_rain = [
        '–í–æ—Ç –∏ —Ä–∞—Å–ø–æ–≥–æ–¥–∏–ª–æ—Å—å, –¥–∞–∂–µ –ø–æ—Å–≤–µ–∂–µ–µ —Å—Ç–∞–ª–æ',
        '–ö–∞–∫ –∑–¥–æ—Ä–æ–≤–æ, –≤—Å–µ —Ç—É—á–∫–∏ –º–∏–≥–æ–º –∏—Å—á–µ–∑–ª–∏',
    ]

    rainy_weather = [
        '–û–π, –≤–æ—Ç –∏ –¥–æ–∂–¥—å –ø–æ—à–µ–ª, —Ö–æ—Ä–æ—à–æ, —á—Ç–æ –∑–æ–Ω—Ç–∏–∫ –≤–∑—è–ª–∏',
        '–í–æ—Ç —ç—Ç–æ –ª–∏–≤–µ–Ω—å –∑–∞—Ä—è–¥–∏–ª, —Ö–æ—Ç—å –∑–æ–Ω—Ç–∏–∫ —Å —Å–æ–±–æ–π –µ—Å—Ç—å',
        '–í–æ—Ç –∏ –∫–∞–ø–ª–∏ –Ω–∞ –∞—Å—Ñ–∞–ª—å—Ç–µ –ø–æ—è–≤–∏–ª–∏—Å—å, –ø–æ—Ä–∞ –¥–æ—Å—Ç–∞–≤–∞—Ç—å –∑–æ–Ω—Ç',
    ]

    rainy_weather_after_rain = [
        '–†–∞–¥—É–≥–∞ –ø–æ—è–≤–∏–ª–∞—Å—å, –º–æ–∂–µ—Ç —Å–∫–æ—Ä–æ –¥–æ–∂–¥–∏–∫ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è?',
        '–î–æ–∂–¥—å –≤—Å–µ —Å–∏–ª—å–Ω–µ–µ –∏ —Å–∏–ª—å–Ω–µ–µ, —Å–∫–æ—Ä–æ –ø—Ä–∏–¥–µ—Ç—Å—è –ø–ª—ã—Ç—å',
        '–ù–∞ —É–ª–∏—Ü–µ —Ç–µ–º–Ω–æ, –∫–∞–∫ –≥–ª—É–±–æ–∫–æ–π –Ω–æ—á—å—é, –µ—â–µ –∏ –¥–æ–∂–¥—å —Å–ø–ª–æ—à–Ω–æ–π —Å—Ç–µ–Ω–æ–π',
    ]

    was_rainy = False

    for i, step in enumerate(rain_on_the_way):
        print('–ü—Ä–æ—à–ª–∏ ', (i + 1) * 10, '% –ø—É—Ç–∏')
        if not step and not was_rainy:
            print(choice(good_weather))
        elif not step and was_rainy:
            print(choice(good_weather_after_rain))
            was_rainy = False
        elif step and not was_rainy:
            print(choice(rainy_weather))
            was_rainy = True
        elif step and was_rainy:
            print(choice(rainy_weather_after_rain))
        time.sleep(2)

    if sum(rain_on_the_way) > 7:
        print('''–ê –ø–æ–≥–æ–¥–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å –Ω–µ —Å–∞—Ö–∞—Ä, –∏ –¥–∞–∂–µ –∑–æ–Ω—Ç–∏–∫ –Ω–µ —Å–∏–ª—å–Ω–æ –ø–æ–º–æ–≥ :(
–£—Ç–∫–∞ –≤ –∏—Ç–æ–≥–µ –¥–æ—à–ª–∞ –¥–æ –±–∞—Ä–∞, –Ω–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–µ —É—Ç—Ä–æ –ø—Ä–æ—Å—Ç—É–¥–∏–ª–∞—Å—å''')
        # –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å–æ–º—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É, –º–æ–∂–Ω–æ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
        # img = Image.open('flew_donald_duck.jpeg')
        # img.show()
    else:
        print('–£—Ç–∫–∞ –¥–æ—à–ª–∞ –¥–æ –±–∞—Ä–∞ –≤ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–∏ –∏ –≤–µ—Å–µ–ª–æ –ø—Ä–æ–≤–µ–ª–∞ –≤–µ—á–µ—Ä!')
        # –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å–æ–º—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É, –º–æ–∂–Ω–æ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
        # img = Image.open('donald_duck_drunk.jpeg')
        # img.show()


def step2_no_umbrella():
    humidity = get_humidity()
    rain_on_the_way = choices([0, 1], [1 - humidity, humidity], k=10)

    good_weather = [
        '–û—Ç–ª–∏—á–Ω–∞—è –ø–æ–≥–æ–¥–∞, —Å–∞–º–æ–µ –≤—Ä–µ–º—è –ø—Ä–æ–≥—É–ª—è—Ç—å—Å—è',
        '–ö–∞–∫ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –Ω–∞ —É–ª–∏—Ü–µ, –º–æ–∂–Ω–æ –∏ –∫—Ä—É–≥ –ø–æ –¥–æ—Ä–æ–≥–µ —Å–¥–µ–ª–∞—Ç—å',
        '–ü–æ–∫–∞ –∏ —Ç—É—á–µ–∫ –Ω–µ –≤–∏–¥–∞—Ç—å, –º–æ–∂–µ—Ç –∏ –ø—Ä–æ–Ω–µ—Å–µ—Ç',
    ]

    good_weather_after_rain = [
        '–í–æ—Ç –∏ —Ä–∞—Å–ø–æ–≥–æ–¥–∏–ª–æ—Å—å, –¥–∞–∂–µ –ø–æ—Å–≤–µ–∂–µ–µ —Å—Ç–∞–ª–æ',
        '–ö–∞–∫ –∑–¥–æ—Ä–æ–≤–æ, –≤—Å–µ —Ç—É—á–∫–∏ –º–∏–≥–æ–º –∏—Å—á–µ–∑–ª–∏',
    ]

    rainy_weather = [
        '–û–π, –¥–æ–∂–¥–∏–∫ –ø–æ—à–µ–ª, –∞ –æ—Ç—Å—Ç—É–ø–∞—Ç—å —É–∂–µ –Ω–µ–∫—É–¥–∞, –±—ã—Å—Ç—Ä–µ–µ –≤ –±–∞—Ä!',
        '–ß—Ç–æ –∑–∞ –∫–∞–ø–ª–∏ –Ω–∞ –∞—Å—Ñ–∞–ª—å—Ç–µ?! –ù–µ—É–∂–µ–ª–∏ –¥–æ–∂–¥—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è?',
        '–ß—Ç–æ-—Ç–æ –Ω–µ–±–æ –≤—Å–µ —Ç–µ–º–Ω–æ–µ, –Ω–∞–¥–æ –±—ã–ª–æ –±—Ä–∞—Ç—å —Å —Å–æ–±–æ–π –∑–æ–Ω—Ç :(',
    ]

    rainy_weather_after_rain = [
        '–î–æ–∂–¥—å –≤—Å–µ —Å–∏–ª—å–Ω–µ–µ –∏ —Å–∏–ª—å–Ω–µ–µ, –º–æ–∂–Ω–æ —É–∂–µ –ø–ª—ã—Ç—å –ø–æ –ª—É–∂–∞–º',
        '–ö–∞–∫ –∂–µ –º—ã —Ç–∞–∫ –∑–æ–Ω—Ç-—Ç–æ –∑–∞–±—ã–ª–∏? –ü—Ä–∏–¥–µ—Ç—Å—è –æ—Ç–æ–≥—Ä–µ–≤–∞—Ç—å—Å—è –≤ –±–∞—Ä–µ –≥–æ—Ä—è—á–∏–º –≥–ª–∏–Ω—Ç–≤–µ–π–Ω–æ–º!',
    ]

    was_rainy = False

    for i, step in enumerate(rain_on_the_way):
        print('–ü—Ä–æ—à–ª–∏ ', (i + 1) * 10, '% –ø—É—Ç–∏')
        if not step and not was_rainy:
            print(choice(good_weather))
        elif not step and was_rainy:
            print(choice(good_weather_after_rain))
            was_rainy = False
        elif step and not was_rainy:
            if i < 5:
                print('''–û–π, –¥–æ–∂–¥—å –ø–æ—à–µ–ª, –ø—Ä–∏—à–ª–æ—Å—å –≤–µ—Ä–Ω—É—Ç—å—Å—è –¥–æ–º–æ–π, –∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å—Å—è —É–∂–µ –ø–æ–∑–¥–Ω–æ :(
–ë—É–¥–µ–º —Å–∏–¥–µ—Ç—å –¥–æ–º–∞, —Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –¥–æ–∂–¥—å –∏ –≥—Ä—É—Å—Ç–∏—Ç—å...''')
                # –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å–æ–º—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É, –º–æ–∂–Ω–æ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
                # img = Image.open('donald_duck_sad.png')
                # img.show()
                return
            else:
                print(choice(rainy_weather))
                was_rainy = True
        elif step and was_rainy:
            print(choice(rainy_weather_after_rain))
        time.sleep(2)

    if sum(rain_on_the_way) >= 3:
        print('''–ö–æ–µ-–∫–∞–∫ –º—ã –¥–æ–±–µ–∂–∞–ª–∏ –¥–æ –±–∞—Ä–∞, –Ω–æ —É—Ç–∫–∞ –≤—Å–µ –∂–µ —É—Å–ø–µ–ª–∞ –ø—Ä–æ—Å—Ç—ã—Ç—å!
–°–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å –¥–ª—è –Ω–µ–µ –±—ã–ª —Å–æ–≤—Å–µ–º –Ω–µ —Å–∞—Ö–∞—Ä :(''')
        # –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å–æ–º—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É, –º–æ–∂–Ω–æ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
        # img = Image.open('flew_donald_duck.jpeg')
        # img.show()
    else:
        print('–§—É—Ö, –¥–∞ –Ω–∞–º –ø–æ–≤–µ–∑–ª–æ, —É—Ç–∫–∞ —É—Å–ø–µ–ª–∞ –¥–æ–±–µ–∂–∞—Ç—å –¥–æ –±–∞—Ä–∞, –Ω–µ –ø–æ–ø–∞–≤ –ø–æ–¥ –¥–æ–∂–¥—å, –∏ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –ø—Ä–æ–≤–µ–ª–∞ –≤—Ä–µ–º—è!')
        # –µ—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å–æ–º—Ç—Ä–µ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É, –º–æ–∂–Ω–æ —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å
        # img = Image.open('donald_duck_drunk.jpeg')
        # img.show()


if __name__ == '__main__':
    step1()
